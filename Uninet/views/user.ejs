<!-- USER MANAGEMENT -->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <title> UniNet Express Lane Services </title>
  <!-- core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/font-awesome.min.css" rel="stylesheet">    
  <link href="css/animate.min.css" rel="stylesheet">
  <link href="css/owl.carousel.css" rel="stylesheet">
  <link href="css/owl.transitions.css" rel="stylesheet">
  <link href="css/prettyPhoto.css" rel="stylesheet">
  <link href="css/main.css" rel="stylesheet">
  <link href="css/responsive.css" rel="stylesheet">
  <link href="css/jquery.dataTables.min.css" rel="stylesheet">
  <!--[if lt IE 9]>
  <script src="js/html5shiv.js"></script>
  <script src="js/respond.min.js"></script>
  <![endif]-->    

  <!-- Alternative Style -->
  <!-- <link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css"> -->

  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/mousescroll.js"></script>
  <script src="js/smoothscroll.js"></script>
  <script src="js/jquery.prettyPhoto.js"></script>
  <script src="js/jquery.isotope.min.js"></script>
  <script src="js/jquery.inview.min.js"></script>
  <script src="js/wow.min.js"></script>
  <script src="js/main.js"></script>
  <script src="js/jquery.dataTables.min.js"></script> 


  <!-- <link rel="shortcut icon" href="images/ico/favicon.ico"> -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="images/ico/apple-touch-icon-57-precomposed.png">

</head>

<body>
  <header id="header">
    <nav id="main-menu" class="navbar navbar-default navbar-fixed-top" role="banner">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><img src="uninet_navbar.gif" style="display:inline-block; height:60px" alt="logo">&nbsp&nbsp&nbsp
          <font>UniNet Express Lane Services</font></a>
        </div>
        <% include ./menuadmin %>
      </div><!--/.container-->
    </nav>
  </header>

  <section id="status"> 
    <div class="container">
      <div class="section-header">
        <h2 class="section-title text-center wow fadeInDown">User Management</h2>
        <p class="text-center wow fadeInDown">การจัดการ User</p>
      </div>
    </div>
  </section>

  <section id="email_template">
    <div class="container">
      <div class="row">
        <div class="features">
          <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#user">Users Management</a></li>
            <li><a data-toggle="tab" href="#history">Users Access Logs</a></li>
          </ul>

          <div class="tab-content">
            <!-- User Management -->
            <div id="user" class="tab-pane fade in active">
              <!-- User Requested -->
              <table id="usersrequest" class="table table-striped">
                <thead>
                  <tr bgcolor="#1E90FF">
                    <td colspan="8"><center><label><font color="white">User Requested</font></label></center></td>
                  </tr>
                  <tr>
                    <th>Username</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Phone Number</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody> 
                  <!-- data1 = list of user requested -->
                  <% if(data1.length){            
                    for(var i = 0;i < data1.length;i++) { %>
                      <tr>
                        <td><%=data1[i].username%></td>
                        <td><%=data1[i].NameE%></td>
                        <td><%=data1[i].LastNameE%></td>
                        <td><%=data1[i].email%></td>
                        <td><%=data1[i].phone%></td>
                        <td>
                          <div class="dropdown">
                            <button class="btn btn-default btn-md dropdown-toggle dropdown-menu-right" type="button" data-toggle="dropdown"><span class="fa fa-navicon" aria-hidden="true"></span> Action</button>
                            <ul class="dropdown-menu">
                              <li><a data-toggle="modal" href="#detail<%=data1[i].id%>"><span class="fa fa-vcard" aria-hidden="true"></span> Detail</a></li>
                              <li><a href="/user/accept/<%=data1[i].id%>"><span class="fa fa-check" aria-hidden="true"></span> Accept</a></li>
                              <li><a data-toggle="modal" href="#myModal<%=data1[i].id%>"><span class="fa fa-close" aria-hidden="true"></span> Decline</a></li>
                            </ul>
                          </div>
                        </td>
                      </tr>
                    <% }
                  } %>
                  <% if(data1.length){                    
                    for(var i = 0;i < data1.length;i++) { %>
                      <div id="detail<%=data1[i].id%>" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-body">
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> Username</label><label class="col-xs-1 control-label"> : </label>        
                                <div class="col-xs-7">
                                  <%=data1[i].username%>
                                </div>
                              </div>
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> First Name</label><label class="col-xs-1 control-label"> : </label>     
                                <div class="col-xs-7">
                                  <%=data1[i].NameE%>
                                </div>
                              </div>
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> Last Name</label><label class="col-xs-1 control-label"> : </label>
                                <div class="col-xs-7">
                                  <%=data1[i].LastNameE%>
                                </div>
                              </div>
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> Organization</label><label class="col-xs-1 control-label"> : </label>
                                <div class="col-xs-7">
                                  <%=data1[i].org%>
                                </div>
                              </div>
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> Phone number</label><label class="col-xs-1 control-label"> : </label>
                                <div class="col-xs-7">
                                  <%=data1[i].phone%>
                                </div>
                              </div>
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> Email</label><label class="col-xs-1 control-label"> : </label>
                                <div class="col-xs-7">
                                  <%=data1[i].email%>
                                </div>
                              </div>
                              <br>
                              <div class="form-group">
                                <label class="col-xs-4 control-label"> Note</label> 
                                <label class="col-xs-8 control-label"> </label> 
                              </div>
                              <br>
                              <div class="form-group">
                                <div class="col-xs-12"> 
                                  <%=data1[i].message%>
                                </div>
                              </div>
                              <br><br>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                            </div>
                          </div> <!-- class="modal-content" -->
                        </div> <!-- class="modal-dialog" -->
                      </div> <!-- id="detail<%=data1[i].id%>" -->
                    <% }     
                  } %>
                </tbody>
              </table>
              <!-- User Requested -->
              <hr>
              <!-- All User -->
              <table id="allusers" class="table table-striped">  
                <thead>
                  <tr bgcolor="#006DA6">
                    <td colspan="8"><center><label><font color="white">All Users</font></label></center></td>
                  </tr>
                  <tr>
                    <th>Username</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Active</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <% if(data.length){
                    for(var i = 0;i < data.length;i++) { %>
                      <tr>
                        <td><%=data[i].username%></td>
                        <td><%=data[i].NameE%></td>
                        <td><%=data[i].LastNameE%></td>
                        <td><%=data[i].email%></td>
                        <td><% if(data[i].flag === 0) {%>
                            <button type="button" class="btn btn-danger btn-xs">Offline</button>
                          <% }if(data[i].flag === 1) {%>
                            <button type="button" class="btn btn-success btn-xs">Online</button>
                          <%}%>
                        </td>
                        <td>
                          <div class="dropdown"><button class="btn btn-default btn-md dropdown-toggle dropdown-menu-right" type="button" data-toggle="dropdown"><span class="fa fa-navicon" aria-hidden="true"></span> Action</button>
                            <ul class="dropdown-menu">
                              <li><a data-toggle="modal" href="#edit<%=data[i].id%>"><span class="fa fa-pencil-square-o" aria-hidden="true"></span> Edit</a></li>
                              <li><a data-toggle="modal" href="#myModal<%=data[i].id%>"><span class="fa fa-close" aria-hidden="true"></span> Delete</a></li>
                            </ul>
                          </div>
                        </td>
                      </tr>                   
                    <% }
                  }else{ %>
                    <tr>
                      <td colspan="6"><center>No User</center></td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
              <!-- All User -->

              <% if(data1.length){
                for(var i = 0;i < data1.length;i++) { %>
                  <div id="myModal<%=data1[i].id%>" class="modal fade" role="dialog">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-body">
                          <h4><center> Are You Sure? </center></h4>
                        </div>
                        <div class="modal-footer">
                          <a class="btn btn-success" href="/user/delete/<%=data1[i].id%>">Delete</a>
                          <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                        </div>
                      </div>
                    </div>
                  </div> 
                <% }
              } %>
              <% if(data.length){
                for(var i = 0;i < data.length;i++) { %>
                  <div id="myModal<%=data[i].id%>" class="modal fade" role="dialog">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-body">
                          <h4><center> Are You Sure? </center></h4>
                        </div>
                        <div class="modal-footer">
                          <a class="btn btn-success" href="/user/delete/<%=data[i].id%>">Delete</a>
                          <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                        </div>
                      </div> <!-- class="modal-content" -->
                    </div> <!-- class="modal-dialog" -->
                  </div> 
                <% }
              } %>
              <% if(data.length){
                for(var i = 0;i < data.length;i++) { %>
                  <div id="edit<%=data[i].id%>" class="modal fade" role="dialog">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-body">
                          <h4><form action="/user/edit/<%=data[i].id%>" method="post">
                            <div class="form-group">
                              <label>Username</label> 
                              <input type="text" class="form-control" name="username" id="username" placeholder="username" value="<%=data[i].username%>" required="true">
                            </div>
                            <div class="form-group">
                              <label>First Name</label>
                              <input type="text" class="form-control" name="NameE" id="NameE" placeholder="NameE" value="<%=data[i].NameE%>" required="true">
                            </div>
                            <div class="form-group">
                              <label>Last Name</label>
                              <input type="text" class="form-control" name="LastNameE" id="LastNameE" placeholder="LastNameE" value="<%=data[i].LastNameE%>" required="true">
                            </div>
                            <div class="form-group">
                              <label> Organization</label>
                              <select name="org" class="form-control" value="<%=data[i].org%>" title="Organization" required>
                                <option value="">Please Select</option>
                                <option value="1"<% if(data[i].org === 1) { %>
                                    selected="selected"
                                  <% } %>>Chulalongkorn University
                                </option>
                                <option value="2"<% if(data[i].org === 2) { %>
                                    selected="selected"
                                  <% } %>>Kasetsart University
                                </option>
                                <option value="3"<% if(data[i].org === 3) { %>
                                    selected="selected"
                                  <% } %>>Khon Kean University
                                </option>
                                <option value="4"<% if(data[i].org === 4) { %>
                                    selected="selected"
                                  <% } %>>Chiang Mai University
                                </option>
                                <option value="5"<% if(data[i].org === 5) { %>
                                    selected="selected"
                                  <% } %>>Thaksin University
                                </option>
                                <option value="6"<% if(data[i].org === 6) { %>
                                    selected="selected"
                                  <% } %>>King Mongkut's University of Technology Thonburi
                                </option>
                                <option value="7"<% if(data[i].org === 7) { %>
                                    selected="selected"
                                  <% } %>>King Mongkut's University of Technology North Bangkok
                                </option>
                                <option value="8"<% if(data[i].org === 8) { %>
                                    selected="selected"
                                  <% } %>>Suranaree University of Technology
                                </option>
                                 <option value="9"<% if(data[i].org === 9) { %>
                                    selected="selected"
                                  <% } %>>Thammasat University
                                </option>
                                <option value="10"<% if(data[i].org === 10) { %>
                                    selected="selected"
                                  <% } %>>Nakhon Phanom University
                                </option>
                                <option value="11"<% if(data[i].org === 11) { %>
                                    selected="selected"
                                  <% } %>>Princess of Naradhiwas University
                                </option>
                                <option value="12"<% if(data[i].org === 12) { %>
                                    selected="selected"
                                  <% } %>>Naresuan University
                                </option>
                                <option value="13"<% if(data[i].org === 13) { %>
                                    selected="selected"
                                  <% } %>>Burapha University
                                </option>
                                <option value="14"<% if(data[i].org === 14) { %>
                                    selected="selected"
                                  <% } %>>University of Phayao
                                </option>
                                <option value="15"<% if(data[i].org === 15) { %>
                                    selected="selected"
                                  <% } %>>Mahasarakham University
                                </option>
                                <option value="16"<% if(data[i].org === 16) { %>
                                    selected="selected"
                                  <% } %>>Mahidol University
                                </option>
                                <option value="17"<% if(data[i].org === 17) { %>
                                    selected="selected"
                                  <% } %>>Maejo University
                                </option>
                                <option value="18"<% if(data[i].org === 18) { %>
                                    selected="selected"
                                  <% } %>>Mae Fah Luang University
                                </option>
                                <option value="19"<% if(data[i].org === 19) { %>
                                    selected="selected"
                                  <% } %>>Walailak University
                                </option>
                                <option value="20"<% if(data[i].org === 20) { %>
                                    selected="selected"
                                  <% } %>>Srinakharinwirot University
                                </option>
                                <option value="21"<% if(data[i].org === 21) { %>
                                    selected="selected"
                                  <% } %>>Silpakorn University
                                </option>
                                <option value="22"<% if(data[i].org === 22) { %>
                                    selected="selected"
                                  <% } %>>Prince of Songkla University
                                </option>
                                <option value="23"<% if(data[i].org === 23) { %>
                                    selected="selected"
                                  <% } %>>Ubon Ratchathani University
                                </option>
                                <option value="24"<% if(data[i].org === 24) { %>
                                    selected="selected"
                                  <% } %>>King Mongkut's Institute of Technology Ladkrabang
                                </option>
                              </select>
                            </div>
                            <div class="form-group">
                              <label> Phone number</label>
                              <input type="text" class="form-control" name="phone" id="phone" placeholder="phone" value="<%=data[i].phone%>" required="true">
                            </div>
                            <div class="form-group">
                              <label> Email</label>
                              <input type="text" class="form-control" name="email" id="email" placeholder="email" value="<%=data[i].email%>" required="true">
                            </div>
                            <div class="form-group">
                              <label> Member Type</label>
                              <select name="membertype" class="form-control" title="membertype" required="true">
                                <option value="">Please Select</option>
                                <option value=0 <% if(data[i].membertype === 0) { %>
                                    selected="selected"
                                  <% } %>>Standard Member
                                </option>
                                <option value=1 <% if(data[i].membertype === 1) { %>
                                    selected="selected"
                                  <% } %>>Premium Member
                                </option>
                                <option value=2 <% if(data[i].membertype === 2) { %>
                                    selected="selected"
                                  <% } %>>Associate Member
                                </option>
                              </select>
                            </div>
                            <div class="form-group">
                              <label>Role</label>
                              <select name="role" class="form-control" title="role" required="true">
                                <option value="">Please Select</option>
                                <option value=1 <% if(data[i].role === 1) { %>
                                  selected="selected"
                                  <% } %>>Admin
                                </option>
                                <option value=2 <% if(data[i].role === 2) { %>
                                    selected="selected"
                                  <% } %>>Member
                                </option>
                              </select>
                            </div> 
                            <div class="modal-footer">
                              <button type="submit" class="btn btn-success" value="save">Save</button>
                              <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                            </div>
                          </form></h4>
                        </div> <!-- class="modal-body" -->
                      </div> <!-- class="modal-content" -->
                    </div> <!--class="modal-dialog"-->
                  </div> <!-- id="edit<%=data[i].id%>" -->
                <% }
              } %>
              <br/>
            </div>
            <!-- End of User Management  -->

            <!-- History -->
            <div id="history" class="tab-pane fade">
              <table id="userhistorytable" class="table table-striped">
                <thead>
                  <tr bgcolor="#006DA6">
                    <td colspan="8"><center><label><font color="white">User Access Logs</font></label></center></td>
                  </tr>
                  <tr>
                    <th>Username</th>
                    <th>Timestamp</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <% if(userhistory.length){             
                    for(var i = 0;i < userhistory.length;i++) { %>
                    <tr>
                      <td style="width: 30%"><%=userhistory[i].user%></td>
                      <td style="width: 50%"><%=userhistory[i].timestamp%></td>
                      <td style="width: 20%"><%=userhistory[i].nameE%></td>
                    </tr>                   
                    <%}
                  }%>
                </tbody>
              </table> <!-- id="userhistorytable" -->
            </div> <!-- id="history" -->
            <!-- End of History Tab -->
          </div> <!--  -->
        </div> <!--  -->
      </div> 
    </div> 
  </section>

  <footer id="footer">
    <div class="container">
        <div class="row">
          <%include ./footer %>
        </div>
      </div>
  </footer><!--/#footer-->
    
  <script type="text/javascript">
  $(document).ready(function($) {
    $('#usersrequest').dataTable({
        "pagingType": "full_numbers"
    });
    $('#allusers').dataTable({
        "pagingType": "full_numbers"
    });
    $('#userhistorytable').dataTable({
        "pagingType": "full_numbers"
    });
  } );
  </script>
</body>
</html>

